# SSE 技术演示

这是一个基于 Node.js Express 后端和 Vue3 前端的 Server-Sent Events (SSE) 技术演示项目，用于展示服务器向客户端单向推送实时数据的能力。

## 什么是 SSE？

Server-Sent Events (SSE) 是一种服务器向客户端推送实时数据的技术，它建立在 HTTP 协议之上，允许服务器主动向客户端发送事件流。与 WebSocket 相比，SSE 更轻量，适用于单向数据推送场景（如实时通知、日志流、状态更新等）。

## 技术栈

- **后端**：Node.js + Express
- **前端**：Vue3
- **通信协议**：Server-Sent Events (SSE)

## 项目主干结构

```plaintext
sse-demo/
├── server
|	   └── server.js   # Express 后端服务，包含多个 SSE 端点
└── sse-frontend/
	   |
      src/
       └── SSEDemo.vue    # Vue3 前端组件，展示 SSE 交互功能
```

## 功能说明

### 后端 SSE 端点

1. **基础 SSE 连接** (`/sse`)
   - 建立基础 SSE 连接
   - 每 30 秒发送心跳包保持连接
   - 支持客户端断开自动清理
2. **流式文本演示** (`/stream-text`)
   - 逐字推送预设文本内容
   - 模拟实时打字效果
   - 支持多段文本自动换行
3. **状态更新流** (`/sse-data`)
   - 每秒推送随机数据
   - 包含自定义 `status` 事件
   - 支持连接状态跟踪（connected/pause/done）
4. **心跳广播** (`/send-heartbeat`)
   - 手动触发向所有连接客户端发送心跳
   - 支持自定义消息（通过 `?msg=xxx` 参数）
5. **文本广播** (`/broadcast-text`)
   - 向所有连接的客户端广播文本消息
   - 支持自定义消息（通过 `?msg=xxx` 参数）
6. **动态计数器** (`/dynamic-counter`)
   - 每秒推送递增计数器
   - 30 次后自动结束
7. **JSON 动态更新流** (`/stream-json`)
   - 每 1.5 秒推送随机 JSON 数据
   - 包含自定义 `alert` 事件（周期性触发）

### 前端功能

- 连接 / 断开 SSE 服务
- 启动流式文本展示
- 实时显示连接状态和消息计数
- 展示接收的实时消息列表
- 模拟打字机效果的流式文本输出

## 快速开始

### 后端启动

1. 安装依赖：

```bash
npm install express cors
```

1. 启动服务：

```bash
node server.js
```

服务将运行在 `http://localhost:3000`

### 前端启动

1. 确保已集成到 Vue3 项目中（如使用 Vite 或 Vue CLI 创建）
2. 运行前端项目：

```bash
npm run dev
```

（具体命令根据你的 Vue 项目配置调整）

1. 访问前端页面，即可看到 SSE 演示界面

## 使用说明

1. 点击 "连接 SSE" 按钮，建立与 `/sse-data` 端点的连接
2. 连接成功后，会实时接收服务器推送的随机数据
3. 点击 "开始流式文本" 按钮，从 `/stream-text` 端点接收逐字推送的文本
4. 可通过 "断开连接" 按钮手动关闭 SSE 连接
5. 状态区域会显示当前连接状态、接收消息数和事件类型

## 注意事项

- SSE 基于 HTTP 长连接，服务器需要正确设置响应头
- 客户端断开连接时，服务器会自动清理资源
- 心跳机制用于防止连接被代理或浏览器主动关闭
- 跨域请求已在后端通过 `cors` 中间件处理

## 扩展建议

- 可添加认证机制，限制 SSE 连接权限
- 扩展更多事件类型，适应不同业务场景
- 增加错误重试机制，提高连接稳定性
- 集成实际业务数据（如实时日志、监控指标等）